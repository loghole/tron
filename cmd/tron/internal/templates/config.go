package templates

import (
	"sort"
	"strings"

	"github.com/loghole/tron/cmd/tron/internal/helpers"
)

type ConfigData struct {
	Values []ConfigValue
}

func (c *ConfigData) SortValues() {
	sort.Slice(c.Values, func(i, j int) bool { return c.Values[i].Name < c.Values[j].Name })
}

type ConfigValue struct {
	Name string
	Key  string
}

func NewConfigValue(key string) ConfigValue {
	name := helpers.UpperCamelCase(helpers.GoName(key))

	return ConfigValue{Name: name, Key: strings.ToLower(key)}
}

const ConfigConstTemplate = `// Code generated by tron. DO NOT EDIT.
package config

const (
	{{ range $v := .Values -}}
	{{ $v.Name }} = "{{ $v.Key }}"
	{{ end }}
)
`

const ConfigTemplate = `// Code generated by tron. Place config helpers here.
package config

import (
	"github.com/spf13/viper"
)

// GetExampleValue returns ExampleValue from viper config.
func GetExampleValue() string {
	return viper.GetString(ExampleValue)
}
`
